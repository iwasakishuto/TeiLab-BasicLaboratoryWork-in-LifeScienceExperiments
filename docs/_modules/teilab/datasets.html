

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>teilab.datasets &mdash; UiTei-Lab&#39;s Course Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/popup.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../../_static/custom.js"></script>
        <script src="../../_static/particles.min.js"></script>
        <script src="../../_static/popup.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> UiTei-Lab's Course Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
<ul class="utility-btns">
  <li>
    <a class="btn btn-icon btn-start" href="#" onclick="changeParticles(this);"
      >Start Particles</a
    >
  </li>
  <li>
    <a class="btn btn-icon btn-expand" href="#" onclick="changeStyle(this);"
      >Expand</a
    >
  </li>
</ul>
<div class="sidebarlogo">
  <h4>Lab's information</h4>
  <ul class="social">
    
    <li>
      <a class="sc-book" href="http://ui-tei.rnai.jp/" target="_blank">
        <i class="fa fa-book" aria-hidden="true"></i>
      </a>
    </li>
    
    <li>
      <a class="sc-wikipedia-w" href="http://ui-tei.rnai.jp/microarray/doku.php?id=2021" target="_blank">
        <i class="fa fa-wikipedia-w" aria-hidden="true"></i>
      </a>
    </li>
    
    <li>
      <a class="sc-file-pdf-o" href="https://doi.org/10.1021/acsomega.7b00291/" target="_blank">
        <i class="fa fa-file-pdf-o" aria-hidden="true"></i>
      </a>
    </li>
    
    <li>
      <a class="sc-slideshare" href="https://iwasakishuto.github.io/TeiLab-BasicLaboratoryWork-in-LifeScienceExperiments/slides/index.html" target="_blank">
        <i class="fa fa-slideshare" aria-hidden="true"></i>
      </a>
    </li>
    
  </ul>
  <h4>Author's Social link</h4>
  <ul class="social">
    
    <li>
      <a class="sc-twitter" href="https://twitter.com/cabernet_rock" target="_blank">
        <i class="fa fa-twitter" aria-hidden="true"></i>
      </a>
    </li>
    
    <li>
      <a class="sc-github" href="https://github.com/iwasakishuto" target="_blank">
        <i class="fa fa-github" aria-hidden="true"></i>
      </a>
    </li>
    
  </ul>
</div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../teilab.html">teilab package</a></li>
</ul>

            
          
        </div>
         
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">UiTei-Lab's Course Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
<canvas class="particle-background"></canvas>

        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>teilab.datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for teilab.datasets</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="sd">&quot;&quot;&quot;This module handles Datasets used in the lecture. The table below describes the meaning of the values in each column of the data used in the lecture. If you want to refer each class or method, click :py:class:`HERE &lt;teilab.datasets.Samples&gt;` to skip it.</span>

<span class="sd">Reference: `Agilent Feature Extraction 12.0 Reference Guide &lt;https://www.agilent.com/cs/library/usermanuals/public/G4460-90052_FE_RefGuide.pdf&gt;`_</span>

<span class="sd">########</span>
<span class="sd">FEATURES</span>
<span class="sd">########</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">    &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=True)</span>
<span class="sd">    &gt;&gt;&gt; df_data = datasets.read_data(no=0)</span>
<span class="sd">    &gt;&gt;&gt; df_data.columns</span>
<span class="sd">        Index([&#39;FEATURES&#39;, &#39;FeatureNum&#39;, &#39;Row&#39;, &#39;Col&#39;, &#39;accessions&#39;, ... ], dtype=&#39;object&#39;)</span>

<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| G2505C | G2600D |              Features              | Types |                                                                                                                                                                                                                                          Description                                                                                                                                                                                                                                          |</span>
<span class="sd">+========+========+====================================+=======+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+</span>
<span class="sd">|  1     |  1     | ``FeatureNum``                     | int   | Feature number.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  2     |  2     | ``Row``                            | int   | Feature location: row.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  3     |  3     | ``Col``                            | int   | Feature location: column.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  4     |        | ``accessions``                     | str   | Gene accession numbers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  5     |        | ``chr_coord``                      | str   | Chromosome coordinates of the feature.                                                                                                                                                                                                                                                                                                                                                                                                                                                        |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  6     |  4     | ``SubTypeMask``                    | int   | Numeric code defining the subtype of any control feature.                                                                                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  7     |        | ``SubTypeName``                    | int   | Name of the subtype of any control feature.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  8     |        | ``Start``                          | int   | Indicates the place in the transcript where the probe sequence starts.                                                                                                                                                                                                                                                                                                                                                                                                                        |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|  9     |        | ``Sequence``                       | str   | The sequence of bases printed on the array.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 10     |        | ``ProbeUID``                       | int   | Unique integer for each unique probe in a design.                                                                                                                                                                                                                                                                                                                                                                                                                                             |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 11     |  5     | ``ControlType``                    | int   | Feature control type.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 12     |  6     | ``ProbeName``                      | str   | An Agilent-assigned identifier for the probe synthesized on the microarray.                                                                                                                                                                                                                                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 13     |        | ``GeneName``                       | str   | This is an identifier for the gene for which the probe provides expression information. The target sequence identified by the systematic name is normally a representative or consensus sequence for the gene.                                                                                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 14     |  7     | ``SystematicName``                 | str   | This is an identifier for the target sequence that the probe was designed to hybridize with. Where possible, a public database identifier is used (e.g., TAIR locus identifier for Arabidopsis). ``SystematicName`` is reported ONLY if Gene name and Systematic name are different.                                                                                                                                                                                                          |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 15     |        | ``Description``                    | str   | Description of gene.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 16     |  8     | ``PositionX``                      | float | Found coordinates (X) of the feature centroid in microns.                                                                                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 17     |  9     | ``PositionY``                      | float | Found coordinates (Y) of the feature centroid in microns.                                                                                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 18     |        | ``gSurrogateUsed``                 | float | If ``gSurrogateUsed`` is Non-zero value, The g surrogate value used. Otherwise, No surrogate value used.                                                                                                                                                                                                                                                                                                                                                                                      |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 19     |        | ``gIsFound``                       | bool  | A boolean used to flag found features. The flag is applied independently in each channel. (``1`` = IsFound, ``0`` = IsNotFound) A feature is considered Found if two conditions are true: 1) the difference between the feature signal and the local background signal is more than 1.5 times the local background noise and 2) the spot diameter is at least 0.30 times the nominal spot diameter.                                                                                           |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 20     | 10     | ``gProcessedSignal``               | float | The signal left after all the Feature Extraction processing steps have been completed. In the case of one color, ``ProcesssedSignal`` contains the Multiplicatively Detrended BackgroundSubtracted Signal if the detrending is selected and helps. If the detrending does not help, this column will contain the ``BackgroundSubtractedSignal``.                                                                                                                                              |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 21     | 11     | ``gProcessedSigError``             | float | The universal or propagated error left after all the processing steps of Feature Extraction have been completed. In the case of one color, ``ProcessedSignalError`` has had the Error Model applied and will contain at least the larger of the universal (UEM) error or the propagated error. If multiplicative detrending is performed, ``ProcessedSignalError`` contains the error propagated from detrending. This is done by dividing the error by the normalized ``MultDetrendSignal``. |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 22     |        | ``gNumPixOLHi``                    | int   | Number of outlier pixels per feature with intensity &gt; upper threshold set via the pixel outlier rejection method. The number is computed independently in each channel. These pixels are omitted from all subsequent calculations.                                                                                                                                                                                                                                                            |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 23     |        | ``gNumPixOLLo``                    | int   | Number of outlier pixels per feature with intensity &lt; lower threshold set via the pixel outlier rejection method. The number is computed independently in each channel. These pixels are omitted from all subsequent calculations. NOTE: The pixel outlier method is the ONLY step that removes data in Feature Extraction.                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 24     |        | ``gNumPix``                        | int   | Total number of pixels used to compute feature statistics; i.e. total number of inlier pixels/per spot; same in both channels.                                                                                                                                                                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 25     |        | ``gMeanSignal``                    | float | Raw mean signal of feature from inlier pixels in green and/or red channel.                                                                                                                                                                                                                                                                                                                                                                                                                    |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 26     | 12     | ``gMedianSignal``                  | float | Raw median signal of feature from inlier pixels in green and/or red channel.                                                                                                                                                                                                                                                                                                                                                                                                                  |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 27     |        | ``gPixSDev``                       | float | Standard deviation of all inlier pixels per feature; this is computed independently in each channel.                                                                                                                                                                                                                                                                                                                                                                                          |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 28     |        | ``gPixNormIQR``                    | float | The normalized Inter-quartile range of all of the inlier pixels per feature. The range is computed independently in each channel.                                                                                                                                                                                                                                                                                                                                                             |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 29     |        | ``gBGNumPix``                      | int   | Total number of pixels used to compute local BG statistics per spot; i.e. total number of BG inlier pixels; same in both channels.                                                                                                                                                                                                                                                                                                                                                            |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 30     | 25     | ``gBGMeanSignal``                  | float | Mean local background signal (local to corresponding feature) computed per channel (inlier pixels).                                                                                                                                                                                                                                                                                                                                                                                           |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 31     | 13     | ``gBGMedianSignal``                | float | Median local background signal (local to corresponding feature) computed per channel (inlier pixels).                                                                                                                                                                                                                                                                                                                                                                                         |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 32     | 14     | ``gBGPixSDev``                     | float | Standard deviation of all inlier pixels per local BG of each feature, computed independently in each channel.                                                                                                                                                                                                                                                                                                                                                                                 |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 33     |        | ``gBGPixNormIQR``                  | float | The normalized Inter-quartile range of all of the inlier pixels per local BG of each feature. The range is computed independently in each channel.                                                                                                                                                                                                                                                                                                                                            |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 34     |        | ``gNumSatPix``                     | int   | Total number of saturated pixels per feature, computed per channel.                                                                                                                                                                                                                                                                                                                                                                                                                           |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 35     | 15     | ``gIsSaturated``                   | bool  | Boolean flag indicating if a feature is saturated or not. A feature is saturated. IF 50% of the pixels in a feature are above the saturation threshold. (``1`` = Saturated, ``0`` = Not saturated).                                                                                                                                                                                                                                                                                           |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 36     | 16     | ``gIsFeatNonUnifOL``               | bool  | Boolean flag indicating if a feature is a NonUniformity Outlier or not. A feature is non-uniform if the pixel noise of feature exceeds a threshold established for a &quot;uniform&quot; feature. ``g(r)IsFeatNonUnifOL`` = ``1`` indicates Feature is a non-uniformity outlier in g(r).                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 37     | 17     | ``gIsBGNonUnifOL``                 | bool  | The same concept as above but for background. ``g(r)IsBGNonUnifOL`` = ``1`` indicates Local background is a non-uniformity outlier in g(r).                                                                                                                                                                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 38     | 18     | ``gIsFeatPopnOL``                  | bool  | Boolean flag indicating if a feature is a Population Outlier or not. Probes with replicate features on a microarray are examined using population statistics. A feature is a population outlier if its signal is less than a lower threshold or exceeds an upper threshold determined using a multiplier (1.42) times the interquartile range (i.e., IQR) of the population. ``g(r)IsFeatPopnOL`` = ``1`` indicates Feature is a population outlier in g(r).                                  |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 39     | 19     | ``gIsBGPopnOL``                    | bool  | The same concept as above but for background. ``g(r)IsBGPopnOL`` = ``1`` indicates local background is a population outlier in g(r).                                                                                                                                                                                                                                                                                                                                                          |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 40     | 20     | ``IsManualFlag``                   | bool  | Boolean to flag features for downstream filtering in third party gene expression software.                                                                                                                                                                                                                                                                                                                                                                                                    |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 41     | 21     | ``gBGSubSignal``                   | float | Background-subtracted signal. To display the values used to calculate this variable using different background signals and settings of spatial detrend and global background adjust, see `Table 34 on page 254 &lt;https://www.agilent.com/cs/library/usermanuals/public/G4460-90052_FE_RefGuide.pdf&gt;`_ . ``g(r)BGSubSignal`` = ``g(r)MeanSignal`` - ``g(r)BGUsed``.                                                                                                                             |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 42     |        | ``gBGSubSigError``                 | float | Propagated standard error as computed on net g(r) background-subtracted signal. For one color, the error model is applied to the background-subtracted signal. This will contain the larger of he universal (UEM) error or the propagated error.                                                                                                                                                                                                                                              |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 43     | 22     | ``gIsPosAndSignif``                | bool  | Boolean flag, established via a 2-sided t-test, indicates if the mean signal of a feature is greater than the corresponding background (selected by user) and if this difference is significant. ``g(r)isPosAndSignif`` = 1 indicates Feature is positive and significant above background.                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 44     |        | ``gPValFeatEqBG``                  | float | pValue from t-test of significance between g(r)Mean signal and g(r) background (selected by user).                                                                                                                                                                                                                                                                                                                                                                                            |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 45     |        | ``gNumBGUsed``                     | int   | Number of local background regions or features used to calculate the background used for background subtraction on this feature.                                                                                                                                                                                                                                                                                                                                                              |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 46     | 23     | ``gIsWellAboveBG``                 | bool  | Boolean flag indicating if a feature is WellAbove Background or not, feature passes ``g(r)IsPosAndSignif`` and additionally the g(r)BGSubSignal is greater than ``2.6*g(r)BG_SD``. You can change the multiplier ``2.6``.                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 47     |        | ``gBGUsed``                        | float | Background used to subtract from the MeanSignal; variable also used in t-test. To display the values used to calculate this variable using different background signals and settings of spatial detrend and global background adjust, see `Table 34 on page 254 &lt;https://www.agilent.com/cs/library/usermanuals/public/G4460-90052_FE_RefGuide.pdf&gt;`_ . ``g(r)BGSubSignal`` = ``g(r)MeanSignal`` - ``g(r)BGUsed``.                                                                            |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 48     |        | ``gBGSDUsed``                      | float | Standard deviation of background used in g(r) channel; variable also used in t-test and surrogate algorithms. To display the values used to calculate this variable using different background signals and settings of spatial detrend and global background adjust, see `Table 34 on page 254 &lt;https://www.agilent.com/cs/library/usermanuals/public/G4460-90052_FE_RefGuide.pdf&gt;`_ .                                                                                                        |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 49     |        | ``ErrorModel``                     | bool  | Indicates the error model that you chose for Feature Extraction or that the software uses if you have chosen the &quot;Most Conservative&quot; option. ``0`` = Propagated model chosen by you or by software. ``1`` = Universal error model chosen by you or by software.                                                                                                                                                                                                                               |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 50     |        | ``gSpatialDetrendIsInFilteredSet`` | bool  | Set to true for a given feature if it is part of the filtered set used to detrend the background. This feature is considered part of the locally weighted lowest x% of features as defined by the DetrendLowPassPercentage. ``1`` = Feature in filtered set. ``0`` = Feature not in filtered set.                                                                                                                                                                                             |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 51     |        | ``gSpatialDetrendSurfaceValue``    | float | Value of the smoothed surface calculated by the Spatial detrend algorithm.                                                                                                                                                                                                                                                                                                                                                                                                                    |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 52     | 24     | ``SpotExtentX``                    | float | Diameter of the spot (X-axis).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 53     |        | ``SpotExtentY``                    | float | Diameter of the spot (Y-axis).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 54     |        | ``gNetSignal``                     | float | ``MeanSignal`` minus ``DarkOffset``.                                                                                                                                                                                                                                                                                                                                                                                                                                                          |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 55     |        | ``gMultDetrendSignal``             | float | A surface is fitted through the log of the background-subtracted signal to look for multiplicative gradients. A normalized version of that surface interpolated at each point of the microarray is stored in ``MultDetrendSignal``. The surface is normalized by dividing each point by the overall average of the surface. That average is stored in ``MultDetrendSurfaceAverage`` as a statistic. 1-color only.                                                                             |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 56     |        | ``gProcessedBackground``           | float | Indicates the Background signal that was selected to be used (Mean or Median).                                                                                                                                                                                                                                                                                                                                                                                                                |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 57     |        | ``gProcessedBkngError``            | float | Indicates the Background error that was selected to be used (PixSD or NormIQR) .                                                                                                                                                                                                                                                                                                                                                                                                              |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 58     |        | ``IsUsedBGAdjust``                 | bool  | A Boolean used to flag features used for computation of global BG offset. ``1`` = Feature used. ``0`` = Feature not used.                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 59     |        | ``gInterpolatedNegCtrlSub``        | float | Value at the polynomial fit of the negative controls.                                                                                                                                                                                                                                                                                                                                                                                                                                         |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 60     |        | ``gIsInNegCtrlRange``              | bool  | Set to true for a given feature if its signal intensity is in the negative control range.                                                                                                                                                                                                                                                                                                                                                                                                     |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">| 61     |        | ``gIsUsedInMD``                    | bool  | Indicates whether this feature was included in the set used to generate the multiplicative detrend surface.                                                                                                                                                                                                                                                                                                                                                                                   |</span>
<span class="sd">+--------+--------+------------------------------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">**********************</span>
<span class="sd">Background Subtraction</span>
<span class="sd">**********************</span>

<span class="sd">The feature background-subtracted signal, ``BGSubSignal``, is calculated by subtracting a value called the ``BGUsed`` from the feature mean signal.</span>

<span class="sd">.. math::</span>

<span class="sd">    \\text{ BGSubSignal } = \\text{ MeanSignal } - \\text{ BGUsed }</span>

<span class="sd">where ``BGSubSignal`` and ``BGUsed`` depend on the type of background method and the settings for spatial detrend and global background adjust. See the following table.</span>

<span class="sd">+-------------------------------+---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">| Background Subtraction Method | Background Subtraction Variable |     SpDe OFF / GBA OFF      |         SpDe ON / GBA OFF      |         SpDe OFF /  GBA ON      |                     SpDe ON / GBA ON        |</span>
<span class="sd">+===============================+=================================+=============================+================================+=================================+=============================================+</span>
<span class="sd">| No background subtract        | ``BGUsed`` =                    | ``BGMeanSignal``            | ``SDSV``                       | ``BGAdjust``                    | ``SDSV`` + ``BGAdjust``                     |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSDUsed`` =                  | ``BGPixSDev``               | ``BGPixSDev``                  | ``BGPixSDev``                   | ``BGPixSDev``                               |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSubSignal`` =               | ``MeanSignal``              | ``MeanSignal`` - ``BGUsed``    | ``MeanSignal`` - ``BGUsed``     | ``MeanSignal`` - ``BGUsed``                 |</span>
<span class="sd">+-------------------------------+---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">| Local Background              | ``BGUsed`` =                    | ``BGMeanSignal``            | ``BGMeanSignal`` + ``SDSV``    | ``BGMeanSignal`` + ``BGAdjust`` | ``BGMeanSignal`` + ``SDSV`` + ``BGAdjust``  |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSDUsed`` =                  | ``BGPixSDev``               | ``BGPixSDev``                  | ``BGPixSDev``                   | ``BGPixSDev``                               |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSubSignal`` =               | ``MeanSignal`` - ``BGUsed`` | ``MeanSignal`` - ``BGUsed``    | ``MeanSignal`` - ``BGUsed``     | ``MeanSignal`` - ``BGUsed``                 |</span>
<span class="sd">+-------------------------------+---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">| Global Background method      | ``BGUsed`` =                    | ``GBGIA``                   | ``GBGIA`` + ``SDSV``           | ``GBGIA`` + ``BGAdjust``        | ``GBGIA`` + ``SDSV`` + ``BGAdjust``         |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSDUsed`` =                  | ``GBGISD``                  | ``GBGISD``                     | ``GBGISD``                      | ``GBGISD``                                  |</span>
<span class="sd">+                               +---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>
<span class="sd">|                               | ``BGSubSignal`` =               | ``MeanSignal`` - ``BGUsed`` | ``MeanSignal`` - ``BGUsed``    | ``MeanSignal`` - ``BGUsed``     | ``MeanSignal`` - ``BGUsed``                 |</span>
<span class="sd">+-------------------------------+---------------------------------+-----------------------------+--------------------------------+---------------------------------+---------------------------------------------+</span>

<span class="sd">- SpDe: Spatial Detrend</span>
<span class="sd">- SDSV: ``SpatialDetrendSurfaceValue``</span>
<span class="sd">- GBA: Global Bkgnd Adjust</span>
<span class="sd">- GBGISD: ``GlobalBGInlierSDev``</span>
<span class="sd">- GBGISD: ``GlobalBGInlierSDev``</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">    &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">    &gt;&gt;&gt; df_meta = datasets.read_meta(no=-1)</span>
<span class="sd">    &gt;&gt;&gt; df_meta[&quot;BGSubtractor_BGSubMethod&quot;].values[0]</span>
<span class="sd">        7</span>

<span class="sd">The BGSubMethod of ``7`` corresponds to &quot;No Background Subtraction method&quot; (see `Table 17 on page 129 &lt;https://www.agilent.com/cs/library/usermanuals/public/G4460-90052_FE_RefGuide.pdf&gt;`_ .).</span>

<span class="sd">- Global Background Adjustment is turned Off.</span>
<span class="sd">- Spatial Detrending is turned On.</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">    &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">    &gt;&gt;&gt; df_data = datasets.read_data(no=-1)</span>
<span class="sd">    &gt;&gt;&gt; all(df_data[&quot;gBGUsed&quot;] == df_data[&quot;gSpatialDetrendSurfaceValue&quot;])</span>
<span class="sd">        True</span>
<span class="sd">    &gt;&gt;&gt; all(abs((df_data[&quot;gBGSDUsed&quot;]-df_data[&quot;gBGPixSDev&quot;])/df_data[&quot;gBGSDUsed&quot;])&lt;1e-3)</span>
<span class="sd">        True</span>
<span class="sd">    &gt;&gt;&gt; all(abs((df_data[&quot;gBGSubSignal&quot;]-(df_data[&quot;gMeanSignal&quot;]-df_data[&quot;gBGUsed&quot;]))/df_data[&quot;gBGSubSignal&quot;]) &lt; 1.4e-1)</span>
<span class="sd">        True</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">nptyping</span> <span class="kn">import</span> <span class="n">NDArray</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">from</span> <span class="nn">.utils._config</span> <span class="kn">import</span> <span class="n">GAS_WEBAPP_URL</span>
<span class="kn">from</span> <span class="nn">.utils._path</span> <span class="kn">import</span> <span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">SAMPLE_LIST_PATH</span>
<span class="kn">from</span> <span class="nn">.utils.download_utils</span> <span class="kn">import</span> <span class="n">decide_downloader</span>
<span class="kn">from</span> <span class="nn">.utils.generic_utils</span> <span class="kn">import</span> <span class="n">verbose2print</span>


<div class="viewcode-block" id="Samples"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.Samples">[docs]</a><span class="k">class</span> <span class="nc">Samples</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Utility Sample Class for this lecture.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _df (pd.DataFrame)                     : Sample information described in text file at ``sample_list_path`` .</span>
<span class="sd">        SampleNumber (NDArray[Any,str])        : Index numbers for each sample.</span>
<span class="sd">        FileName (NDArray[Any,str])            : File namse for each sample.</span>
<span class="sd">        Condition (NDArray[Any,str])           : Experimental conditions for each sample.</span>
<span class="sd">        _group_names (NDArray[Any,str])        : ``i-th`` group&#39;s filename prefix.</span>
<span class="sd">        _group_numbers (NDArray[Any,np.uint8]) : Which group (``no``) the ``j-th`` sample belongs to</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from teilab.datasets import Samples</span>
<span class="sd">        &gt;&gt;&gt; from teilab.utils._path import SAMPLE_LIST_PATH</span>
<span class="sd">        &gt;&gt;&gt; samples = Samples(sample_list_path=SAMPLE_LIST_PATH)</span>
<span class="sd">        &gt;&gt;&gt; print(sorted(samples.__dict__.keys()))</span>
<span class="sd">        [&#39;Condition&#39;, &#39;FileName&#39;, &#39;SampleNumber&#39;, &#39;_df&#39;, &#39;_group_names&#39;, &#39;_group_numbers&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_list_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">sample_list_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouping</span><span class="p">()</span>

<div class="viewcode-block" id="Samples.grouping"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.Samples.grouping">[docs]</a>    <span class="k">def</span> <span class="nf">grouping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Grouping the samples based on their filenames.&quot;&quot;&quot;</span>
        <span class="n">group_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">group_numbers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FileName</span><span class="p">:</span>
            <span class="n">gn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">gn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">group_names</span><span class="p">:</span>
                <span class="n">group_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gn</span><span class="p">)</span>
            <span class="n">group_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">gn</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_names</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">group_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_numbers</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">group_numbers</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">cnd</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_names</span><span class="p">[</span><span class="n">gn</span><span class="p">],</span> <span class="n">fn</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">gn</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">cnd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_group_numbers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FileName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Condition</span><span class="p">))</span>
        <span class="p">]</span>

<div class="viewcode-block" id="Samples.show_groups"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.Samples.show_groups">[docs]</a>    <span class="k">def</span> <span class="nf">show_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tablefmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;simple&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Show groups neatly.</span>

<span class="sd">        Args:</span>
<span class="sd">            tablefmt (str, optional) : Table formats. Please choose from [``&quot;plain&quot;``, ``&quot;simple&quot;``, ``&quot;grid&quot;``, ``&quot;pipe&quot;``, ``&quot;orgtbl&quot;``, ``&quot;rst&quot;``, ``&quot;mediawiki&quot;``, ``&quot;latex&quot;``, ``&quot;latex_raw&quot;``, ``&quot;latex_booktabs&quot;``, ``&quot;latex_longtable&quot;``, ``&quot;tsv&quot;``] . Defaults to ``&quot;simple&quot;``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import Samples</span>
<span class="sd">            &gt;&gt;&gt; from teilab.utils._path import SAMPLE_LIST_PATH</span>
<span class="sd">            &gt;&gt;&gt; samples = Samples(sample_list_path=SAMPLE_LIST_PATH)</span>
<span class="sd">            &gt;&gt;&gt; samples.show_groups()</span>
<span class="sd">              idx    gn  GroupName                              FileName</span>
<span class="sd">            -----  ----  -------------------------------------  ---------------------------------------------------</span>
<span class="sd">                0     0  SG19378659_257236339458_S001_GE1_1200  SG19378659_257236339458_S001_GE1_1200_Jun14_1_1.txt</span>
<span class="sd">                1     0  SG19378659_257236339458_S001_GE1_1200  SG19378659_257236339458_S001_GE1_1200_Jun14_1_2.txt</span>
<span class="sd">                :     :                   :                                            :</span>
<span class="sd">               11     1  US91503671_253949442637_S01_GE1_105    US91503671_253949442637_S01_GE1_105_Dec08_1_4.txt</span>
<span class="sd">               12     1  US91503671_253949442637_S01_GE1_105    US91503671_253949442637_S01_GE1_105_Dec08_2_2.txt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="n">tabulate</span><span class="p">(</span>
                <span class="n">tabular_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">,</span>
                <span class="n">tablefmt</span><span class="o">=</span><span class="n">tablefmt</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="s2">&quot;Condition&quot;</span><span class="p">,</span> <span class="s2">&quot;gn&quot;</span><span class="p">,</span> <span class="s2">&quot;GroupName&quot;</span><span class="p">,</span> <span class="s2">&quot;FileName&quot;</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Samples.get_group_numbers"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.Samples.get_group_numbers">[docs]</a>    <span class="k">def</span> <span class="nf">get_group_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_no</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the specified group index List.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_no  (Optional[int], optional)  : [description]. Defaults to ``None``.</span>
<span class="sd">            group_name (Optional[str], optional) : [description]. Defaults to ``None``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[int]: [description]</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import Samples</span>
<span class="sd">            &gt;&gt;&gt; from teilab.utils._path import SAMPLE_LIST_PATH</span>
<span class="sd">            &gt;&gt;&gt; samples = Samples(sample_list_path=SAMPLE_LIST_PATH)</span>
<span class="sd">            &gt;&gt;&gt; samples._group_names</span>
<span class="sd">            [&#39;SG19378659_257236339458_S001_GE1_1200&#39;, &#39;US91503671_253949442637_S01_GE1_105&#39;]</span>
<span class="sd">            &gt;&gt;&gt; samples._group_numbers</span>
<span class="sd">            [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="sd">            &gt;&gt;&gt; samples.get_group_numbers(0)</span>
<span class="sd">            [0, 1, 2, 3, 4]</span>
<span class="sd">            &gt;&gt;&gt; samples.get_group_numbers(group_name=&quot;US91503671_253949442637_S01_GE1_105&quot;)</span>
<span class="sd">            [5, 6, 7, 8, 9, 10, 11, 12]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">group_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_group_numbers</span><span class="p">)</span> <span class="k">if</span> <span class="n">gn</span> <span class="o">==</span> <span class="n">group_no</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="TeiLabDataSets"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets">[docs]</a><span class="k">class</span> <span class="nc">TeiLabDataSets</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Utility Datasets Class for this lecture.</span>

<span class="sd">    Args:</span>
<span class="sd">        verbose (bool, optional) : Whether print verbose or not. Defaults to ``True``.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        verbose (bool)   : Whether print verbose or not. Defaults to ``True``.</span>
<span class="sd">        print (callable) : Print function.</span>
<span class="sd">        sample (Samples) : Datasts Samples.</span>
<span class="sd">        root (Path)      : Root Directory for Datasets. ( ``DATA_DIR`` )</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">        &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">        There are not enough datasets. Use ``.get_data`` to prepare all the required datasets.</span>
<span class="sd">        &gt;&gt;&gt; datasets.satisfied</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; datasets.get_data(password=&quot;PASSWORD1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; datasets.get_data(password=&quot;PASSWORD2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; datasets.satisfied</span>
<span class="sd">        True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TARGET_GeneName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;VIM&quot;</span>  <span class="c1">#: TARGET_GeneName (str) ``GeneName`` of the target RNA (vimentin)</span>
    <span class="n">TARGET_SystematicName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;NM_003380&quot;</span>  <span class="c1">#: TARGET_SystematicName (str) ``SystematicName`` of the target RNA (vimentin)</span>
    <span class="p">)</span>
    <span class="n">ANNO_COLNAMES</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;FeatureNum&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ProbeName&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SystematicName&quot;</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: ANNO_COLNAMES (List[str]) Column names for annotation.</span>
    <span class="n">TARGET_COLNAME</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gProcessedSignal&quot;</span>  <span class="c1">#: TARGET_COLNAME (str) Column name for expression data.</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">:</span> <span class="n">callable</span> <span class="o">=</span> <span class="n">verbose2print</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<div class="viewcode-block" id="TeiLabDataSets.init"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span> <span class="n">Samples</span> <span class="o">=</span> <span class="n">Samples</span><span class="p">(</span><span class="n">SAMPLE_LIST_PATH</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">satisfied</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are not enough datasets. Use ``.get_data`` to prepare all the required datasets.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TeiLabDataSets.get_data"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get data which is necessary for this lecture.</span>

<span class="sd">        Args:</span>
<span class="sd">            password (str) : Password. (Because some data are ubpublished.)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The path to the downloaded file.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.utils import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets()</span>
<span class="sd">            &gt;&gt;&gt; path = datasets.get_teilab_data(password=&quot;PASSWORD&quot;)</span>
<span class="sd">            Try to get data from &lt;SECRET_URL&gt;</span>
<span class="sd">            This is our unpublished data, so please treat it confidential.</span>
<span class="sd">            [Download] URL: &lt;SECRET_URL&gt;</span>
<span class="sd">            * Content-Encoding : None</span>
<span class="sd">            * Content-Length   : 45.9 [MB]</span>
<span class="sd">            * Content-Type     : application/zip</span>
<span class="sd">            * Save Destination : PATH/TO/PASSWORD.zip</span>
<span class="sd">            ===== Progress =====</span>
<span class="sd">            &lt;SECRET FILENAME&gt;	100.0%[####################] 45.3[s] 1.0[MB/s]	eta -0.0[s]</span>
<span class="sd">            Save data at PATH/TO/PASSWORD.zip</span>
<span class="sd">            [Unzip] Show file contents:</span>
<span class="sd">                * &lt;SECRET_FILE_1&gt;</span>
<span class="sd">                * &lt;SECRET_FILE_2&gt;</span>
<span class="sd">                * :</span>
<span class="sd">                * &lt;SECRET_FILE_N&gt;</span>
<span class="sd">            &gt;&gt;&gt; path</span>
<span class="sd">            &#39;PATH/TO/PASSWORD.zip&#39;</span>

<span class="sd">        Below is the code for the GAS(Google Apps Script) API server.</span>

<span class="sd">        .. code-block:: js</span>

<span class="sd">            const P = PropertiesService.getScriptProperties();</span>
<span class="sd">            const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(P.getProperty(&quot;sheetname&quot;))</span>
<span class="sd">            const values = sheet.getRange(&quot;A2:C&quot;).getValues();</span>

<span class="sd">            var Password2dataURL = {};</span>
<span class="sd">            for (let i=0; i&lt;values.length; i++){</span>
<span class="sd">              Password2dataURL[values[i][0]] = values[i].slice(1);</span>
<span class="sd">            }</span>

<span class="sd">            function doPost(e) {</span>
<span class="sd">              var password = e.parameter.password;</span>
<span class="sd">              var response = {</span>
<span class="sd">                message  : &quot;Invalid Password&quot;,</span>
<span class="sd">                dataURL  : &quot;&quot;,</span>
<span class="sd">                password : password</span>
<span class="sd">              };</span>

<span class="sd">              if (password in Password2dataURL){</span>
<span class="sd">                let data = Password2dataURL[password]</span>
<span class="sd">                response.dataURL = data[0]</span>
<span class="sd">                response.message = data[1]</span>
<span class="sd">              }</span>

<span class="sd">              var output = ContentService.createTextOutput();</span>
<span class="sd">              output.setMimeType(ContentService.MimeType.JSON);</span>
<span class="sd">              output.setContent(JSON.stringify(response));</span>
<span class="sd">              return output;</span>
<span class="sd">            }</span>

<span class="sd">        You can also get the data with the command like ``curl`` .</span>

<span class="sd">        .. code-block:: shell</span>

<span class="sd">            $ curl -L &lt;GAS_WEBAPP_URL&gt; \\</span>
<span class="sd">                   -d password=&lt;PASSWORD&gt; \\</span>
<span class="sd">                   -H &quot;Content-Type: application/x-www-form-urlencoded&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the target data URL.</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">GAS_WEBAPP_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="n">dataURL</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dataURL&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataURL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not get the valid URL.</span><span class="se">\n</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Try to get data from </span><span class="si">{</span><span class="n">dataURL</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">downloader</span> <span class="o">=</span> <span class="n">decide_downloader</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">dataURL</span><span class="p">)</span>
            <span class="n">ret</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">downloader</span><span class="o">.</span><span class="n">prepare_for_download</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">dataURL</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data already exists, so do nothing here.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use the specific ``Downloader`` to download the target data.</span>
                <span class="n">downloader</span> <span class="o">=</span> <span class="n">decide_downloader</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">dataURL</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">downloader</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">dataURL</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved data at </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">grouping</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">path</span></div>

<div class="viewcode-block" id="TeiLabDataSets.get_filePaths"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.get_filePaths">[docs]</a>    <span class="k">def</span> <span class="nf">get_filePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Path</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the path list of files used in the lecture.</span>

<span class="sd">        Returns:</span>
<span class="sd">            NDArray[Path]: The path lists for datasets.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.utils import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets()</span>
<span class="sd">            &gt;&gt;&gt; filelists = datasets.get_filePaths()</span>
<span class="sd">            &gt;&gt;&gt; len(filelists)</span>
<span class="sd">            13</span>
<span class="sd">            &gt;&gt;&gt; filelists[0].name</span>
<span class="sd">            &#39;US91503671_253949442637_S01_GE1_105_Dec08_1_1.txt&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fnLists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">FileName</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span>
                <span class="p">[</span><span class="n">path</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*.txt&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">fnLists</span><span class="p">],</span>
                <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">fnLists</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">filePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Path</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The path lists for datasets.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filePaths</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">satisfied</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether to get all necessary data or not.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filePaths</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">FileName</span><span class="p">)</span>

<div class="viewcode-block" id="TeiLabDataSets.read"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">no</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">sep</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">header</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;infer&quot;</span><span class="p">,</span>
        <span class="n">nrows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">usecols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Read sample(s) data as ``pd.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            no (Union[int,str,List[int]])                           : Target sample number(s) or ``&quot;all&quot;`` .</span>
<span class="sd">            sep (Optional[str], optional)                           : Delimiter to use. Defaults to ``&quot;\\t&quot;``</span>
<span class="sd">            header (Union[int,List[int]], optional)                 : Row number(s) to use as the column names, and the start of the data. Defaults to ``&quot;infer&quot;``.</span>
<span class="sd">            nrows (Optional[int], optional)                         : Number of rows of file to read. Useful for reading pieces of large files. Defaults to ``None``.</span>
<span class="sd">            usecols (Optional[Union[List[str],callable]], optional) : Return a subset of the columns. Defaults to ``None``.</span>
<span class="sd">            **kwargs (dict)                                         : Other keyword arguments for ``pd.read_csv`` .</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When argument ``no`` is an instance of unexpected type or is an unexpected value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[pd.DataFrame, List[pd.DataFrame]]: DataFrame of the specified sample(s).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; dfs = datasets.read(no=&quot;all&quot;, header=9)</span>
<span class="sd">            &gt;&gt;&gt; len(dfs)</span>
<span class="sd">            13</span>
<span class="sd">            &gt;&gt;&gt; type(dfs[0])</span>
<span class="sd">            pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;sep&quot;</span><span class="p">:</span> <span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">,</span> <span class="s2">&quot;nrows&quot;</span><span class="p">:</span> <span class="n">nrows</span><span class="p">,</span> <span class="s2">&quot;usecols&quot;</span><span class="p">:</span> <span class="n">usecols</span><span class="p">})</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">no</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_csv</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">no</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">no</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">no</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_csv</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filePaths</span><span class="p">))]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please specify the sample number.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_csv</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">no</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_read_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Read the sample as ``pd.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            no (int)      : Target sample number.</span>
<span class="sd">            kwargs (dict) : Keyword arguments for ``pd.read_csv`` .</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: DataFrame of the specified sample.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; df = datasets._read_csv(no=0, header=9)</span>
<span class="sd">            &gt;&gt;&gt; len(df)</span>
<span class="sd">            62976</span>
<span class="sd">            &gt;&gt;&gt; type(df)</span>
<span class="sd">            pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filePaths</span><span class="p">[</span><span class="n">no</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read data from &#39;</span><span class="si">{</span><span class="n">filepath</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="TeiLabDataSets.read_data"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.read_data">[docs]</a>    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Read sample(s) &#39;expression&#39; data as ``pd.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            no (Union[int,str,List[int]]) : Target sample number(s) or ``&quot;all&quot;`` .</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[pd.DataFrame, List[pd.DataFrame]]: DataFrame of the specified sample(s) &#39;expression&#39; data.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; dfs = datasets.read_data(no=[0,1,2])</span>
<span class="sd">            &gt;&gt;&gt; len(dfs)</span>
<span class="sd">            3</span>
<span class="sd">            &gt;&gt;&gt; len(dfs[0])</span>
<span class="sd">            62976</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">no</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TeiLabDataSets.read_meta"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.read_meta">[docs]</a>    <span class="k">def</span> <span class="nf">read_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Read sample(s) &#39;meta&#39; data as ``pd.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            no (Union[int,str,List[int]]) : Target sample number(s) or ``&quot;all&quot;`` .</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[pd.DataFrame, List[pd.DataFrame]]: DataFrame of the specified sample(s) &#39;meta&#39; data.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; dfs = datasets.read_meta(no=&quot;all&quot;)</span>
<span class="sd">            &gt;&gt;&gt; len(dfs)</span>
<span class="sd">            13</span>
<span class="sd">            &gt;&gt;&gt; len(dfs[0])</span>
<span class="sd">            1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">no</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TeiLabDataSets.read_summary"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.read_summary">[docs]</a>    <span class="k">def</span> <span class="nf">read_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Read sample(s) &#39;summary&#39; data as ``pd.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            no (Union[int,str,List[int]]) : Target sample number(s) or ``&quot;all&quot;`` .</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[pd.DataFrame, List[pd.DataFrame]]: DataFrame of the specified sample(s) &#39;summary&#39; data.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; dfs = datasets.read_summary(no=[0,3,8,9])</span>
<span class="sd">            &gt;&gt;&gt; len(dfs)</span>
<span class="sd">            4</span>
<span class="sd">            &gt;&gt;&gt; len(dfs[0])</span>
<span class="sd">            1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="n">no</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TeiLabDataSets.reliable_filter"><a class="viewcode-back" href="../../teilab.datasets.html#teilab.datasets.TeiLabDataSets.reliable_filter">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">reliable_filter</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a dataframe which means whether data is reliable or not.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame)              : Input dataframe.</span>
<span class="sd">            name (Optional[str], optional) : The column name. Defaults to ``None``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Filter DataFrame which means whether data is reliable or not.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">            &gt;&gt;&gt; from teilab.datasets import TeiLabDataSets</span>
<span class="sd">            &gt;&gt;&gt; datasets = TeiLabDataSets(verbose=False)</span>
<span class="sd">            &gt;&gt;&gt; df_sg = datasets.read_data(0)</span>
<span class="sd">            &gt;&gt;&gt; len(df_sg), datasets.reliable_filter(df_sg).sum().values[0]</span>
<span class="sd">            (62976, 30385)</span>
<span class="sd">            &gt;&gt;&gt; df_us = datasets.read_data(-1)</span>
<span class="sd">            &gt;&gt;&gt; len(df_us), datasets.reliable_filter(df_us).sum().values[0]</span>
<span class="sd">            (62976, 23434)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ControlType</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">present</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">gIsPosAndSignif</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">uniform</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">gIsFeatNonUnifOL</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">wellabove</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">gIsWellAboveBG</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">saturated</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">gIsSaturated</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">popnol</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">gIsFeatPopnOL</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[(</span><span class="n">control</span> <span class="o">&amp;</span> <span class="n">present</span> <span class="o">&amp;</span> <span class="n">uniform</span> <span class="o">&amp;</span> <span class="n">wellabove</span> <span class="o">&amp;</span> <span class="n">saturated</span> <span class="o">&amp;</span> <span class="n">popnol</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, iwasakishuto.

    </p>
  </div> 

</footer>
        </div> 
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    
<style id="style-expand" disabled="true">
  .wy-nav-content {
    max-width: 100% !important;
  }
</style>
<script>
  document.getElementById("style-expand").disabled = true;
</script>


</body>
</html>